<template lang="pug">
el-container
  el-main
    el-row
      el-col(:span="24")
        #echart1.echart
    el-row
      el-col(:span="8") 数据类型
        el-select(v-model="chart1Type.select", placeholder="图表选择",style="width: 100%",size='large',@change='updateNextChart')
          el-option(v-for="item in chart1Type.opt",:key="item.value",:label="item.text",:value="item.value")
    el-row
      el-col(:span="24")
        #echart2.echart
    //- el-row
    //-   el-col(:span="24") 学科选择
    //-     el-select(v-model="appPageStore.subjectSelect",multiple, placeholder="学科选择",clearable,style="width: 100%",size='large',@change='updateChart')
    //-       el-option(v-for="item in option.subject.opt",:key="item",:label="item",:value="item")
    //- el-row 
    //-   el-col(:span="11") 求斜率范围: {{appPageStore.nodeRange[0]}} ~ {{appPageStore.nodeRange[1]}}
    //-     el-slider(v-model="appPageStore.nodeRange", range,:max="10000",:min="10",@change='updateChart')
    //-   el-col(:span="3") 幂律范围
    //-     el-select(v-model="appPageStore.zipfTypeSelect", placeholder="幂律范围",size='large',@change='updateChart')
    //-       el-option(v-for="item in option.type.opt",:key="item.value",:label="item.text",:value="item.value")
    //-   el-col(:span="3") level
    //-     el-select(v-model="appPageStore.levelSelect", placeholder="level",size='large',@change='updateChart')
    //-       el-option(v-for="item in [2,3]",:key="item",:label="item",:value="item")
</template>

<script lang="ts">
export default {
  name: "NFS-stats-2022-07",
  autoIndex: true,
  text: "NFS 数据统计",
  update: "2022-07-21T09:43:03.429Z",
};
</script>

<script setup lang="ts">
import { homeStore } from "@/pinia/modules/pageStore";
import _ from "lodash";
import { reactive, onMounted, ref } from "vue";
import axios from "axios";
import * as echarts from "echarts";
import { extendEchartsOpts } from "@/utils/model";

const url = "https://wiki.lmd.knogen.com:10443/api/wiki/getDfb_newDB";
let loading = ref(false);

const appHomeStore = homeStore();
appHomeStore.title = "NFS 数据统计";

let dataSet = [
  ["year", "NOI", "fundM", "UfundM", "CPI_1", "CPI_2"],
  [1960, 3776, 129.985739, 958.3805684, 12.5, 13.56306078],
  [1961, 3983, 135.536919, 988.7227422, 12.6, 13.70828375],
  [1962, 5083, 214.017773, 1542.73562, 12.8, 13.872615],
  [1963, 5782, 258.429815, 1840.066694, 12.9, 14.04458957],
  [1964, 7325, 375.044366, 2636.662656, 13.1, 14.22420745],
  [1965, 6118, 297.357953, 2057.885336, 13.3, 14.44968521],
  [1966, 6975, 372.438833, 2502.048861, 13.7, 14.88535411],
  [1967, 6879, 760.268811, 4969.696599, 14.1, 15.29809307],
  [1968, 7126, 533.184223, 3342.513244, 14.7, 15.95159642],
  [1969, 7164, 455.359689, 2706.779228, 15.5, 16.82293422],
  [1970, 8215, 436.708039, 2452.713195, 16.4, 17.80510008],
  [1971, 8170, 663.906259, 3575.264325, 17.1, 18.56943148],
  [1972, 10540, 1000.152812, 5215.356433, 17.6, 19.17707495],
  [1973, 10645, 837.818861, 4114.662401, 18.7, 20.36178863],
  [1974, 13115, 1105.634132, 4889.429174, 20.8, 22.61274461],
  [1975, 7015, 531.172638, 2152.216447, 22.7, 24.68026107],
  [1976, 7115, 1565.273069, 5997.652395, 24, 26.09809582],
  [1977, 8277, 921.804244, 3316.449641, 25.6, 27.79491154],
  [1978, 8223, 922.824786, 3084.726931, 27.5, 29.91593119],
  [1979, 8087, 1127.37549, 3387.260436, 30.6, 33.28281103],
  [1980, 8100, 912.692121, 2415.017131, 34.8, 37.79236632],
  [1981, 7532, 1004.383978, 2408.704432, 38.4, 41.6980998],
  [1982, 6264, 1105.167752, 2497.284007, 40.7, 44.25478835],
  [1983, 6743, 942.218822, 2062.811208, 42, 45.67644476],
  [1984, 7782, 1941.194228, 4074.648593, 43.8, 47.64077647],
  [1985, 8387, 1478.565272, 2997.297394, 45.4, 49.32994887],
  [1986, 7589, 1372.858267, 2731.172775, 46.2, 50.26625484],
  [1987, 8467, 2010.136245, 3857.612884, 47.9, 52.10829353],
  [1988, 8356, 1542.692795, 2844.557667, 49.9, 54.23313484],
  [1989, 8920, 3181.892963, 5596.901809, 52.3, 56.8509699],
  [1990, 9642, 2280.522466, 3805.960584, 55.1, 59.91976049],
  [1991, 10764, 2539.991323, 4066.761877, 57.5, 62.45734075],
  [1992, 10755, 3122.12888, 4851.863932, 59.2, 64.34906098],
  [1993, 9663, 2857.700927, 4313.613415, 60.9, 66.24842452],
  [1994, 10416, 3353.263631, 4933.024643, 62.5, 67.9758135],
  [1995, 9815, 2652.168452, 3795.165162, 64.3, 69.88282035],
  [1996, 9532, 2830.0718, 3934.41327, 66.2, 71.93122852],
  [1997, 10188, 4095.887349, 5564.099868, 67.7, 73.61275761],
  [1998, 9890, 3286.029488, 4395.706577, 68.8, 74.75543306],
  [1999, 9600, 5134.541151, 6721.38639, 70.3, 76.39110227],
  [2000, 10432, 4538.145928, 5746.618347, 72.7, 78.97072076],
  [2001, 10428, 5873.983309, 7233.74078, 74.7, 81.20256846],
  [2002, 10945, 5323.313075, 6453.246389, 75.9, 82.49046688],
  [2003, 11592, 6476.695386, 7677.168113, 77.6, 84.36307882],
  [2004, 10926, 4963.672504, 5730.289013, 79.7, 86.62167812],
  [2005, 10412, 5141.969532, 5741.334264, 82.4, 89.56053237],
  [2006, 10886, 5486.255589, 5934.313781, 85.1, 92.44970508],
  [2007, 12122, 5225.36562, 5495.352718, 87.5, 95.08699238],
  [2008, 11746, 7208.0825, 7300.249804, 90.8, 98.73747739],
  [2009, 15241, 8031.160468, 8162.874989, 90.5, 98.38641997],
  [2010, 13821, 7478.627625, 7478.627625, 92, 100],
  [2011, 11953, 6681.19133, 6476.731186, 94.9, 103.1568416],
  [2012, 12306, 6215.17935, 5902.830793, 96.9, 105.2915045],
  [2013, 11703, 5806.421998, 5435.002163, 98.3, 106.8338489],
  [2014, 11984, 6485.451359, 5973.689441, 99.9, 108.5669321],
  [2015, 12929, 5863.173113, 5394.115799, 100, 108.695722],
  [2016, 12994, 7105.548273, 6455.656735, 101.3, 110.0670089],
  [2017, 12203, 7001.69692, 6228.627277, 103.4, 112.4115573],
  [2018, 12622, 8043.733005, 6984.995985, 105.9, 115.1573032],
  [2019, 12163, 5960.158723, 5083.542684, 107.9, 117.2441955],
  [2020, 12804, 5806.112265, 4891.808685, 109.2, 118.6905016],
  [2021, 12300, 5423.631686, 4364.519358, 114.3, 124.2664138],
];

// NSF Directorate Top10 资金分布
let dataSet1 = [
  [
    "year",
    "Direct For Mathematical & Physical Scien",
    "Directorate For Geosciences",
    "Direct For Education and Human Resources",
    "Direct For Computer & Info Scie & Enginr",
    "Direct For Biological Sciences",
    "Directorate For Engineering",
    "Direct For Social, Behav & Economic Scie",
    "Office Of The Director",
    "Dir for Tech, Innovation, & Partnerships",
    "Office Of Information & Resource Mgmt",
  ],
  [1960, 0, 0, 0, 0.125, 0, 0, 0, 4.012, 0, 0],
  [1961, 0, 0, 0, 0.485, 0, 0, 0, 0.078, 0, 0],
  [1962, 0, 0, 0, 1.87, 0, 0, 0, 0.09, 0, 0],
  [1963, 0.412, 2.305, 0, 4.563, 0, 0, 0, 0, 0, 0],
  [1964, 0.033, 0.091, 0, 2.676, 0, 0, 0.234, 0, 0, 0],
  [1965, 0, 0.065, 0, 5.725, 0.144, 0, 0, 0.008, 0, 0],
  [1966, 0.24, 0.042, 0, 0.381, 0.037, 0, 0, 6.6, 0, 0],
  [1967, 84.777, 223.777, 0, 18.813, 1.526, 7.241, 2.853, 19.622, 0, 0],
  [1968, 81.236, 0.967, 0, 2.864, 0.877, 4.878, 0, 11.987, 0, 0],
  [1969, 51.089, 0.721, 0, 12.528, 0.73, 39.627, 0.973, 6.826, 0, 0],
  [1970, 7.111, 14.684, 0, 10.789, 7.386, 3.153, 1, 4.631, 0, 0.003],
  [1971, 41.149, 97.513, 0.382, 12.065, 14.547, 62.905, 2.932, 9.182, 0, 0.179],
  [1972, 178.214, 81.858, 0.724, 32.089, 29.423, 76.687, 4.337, 20.635, 0, 0],
  [1973, 66.159, 43.629, 3.676, 12.602, 26.458, 84.741, 10.28, 24.338, 0, 0],
  [1974, 209.699, 87.048, 3.7, 56.455, 59.417, 76.784, 19.239, 14.04, 0, 0],
  [1975, 112.706, 87.058, 2.03, 65.387, 91.144, 81.201, 16.499, 18.048, 0, 0],
  [1976, 151.786, 1120.185, 3.109, 74.42, 85.705, 82.857, 29.286, 16.668, 0, 0],
  [
    1977, 254.739, 287.134, 6.958, 97.499, 107.304, 93.209, 40.318, 31.067, 0,
    0,
  ],
  [
    1978, 291.989, 239.101, 10.892, 102.637, 128.984, 74.575, 41.892, 28.467, 0,
    0,
  ],
  [
    1979, 354.878, 350.288, 8.164, 101.18, 131.936, 99.415, 37.918, 41.984, 0,
    0.03,
  ],
  [
    1980, 284.243, 139.728, 14.637, 120.289, 154.053, 111.467, 41.933, 43.518,
    0, 0.041,
  ],
  [
    1981, 356.703, 220.913, 2.748, 113.414, 150.899, 92.631, 33.044, 32.929,
    0.1, 0.095,
  ],
  [
    1982, 288.788, 406.947, 18.133, 51.789, 146.056, 123.676, 32.197, 36.595,
    0.378, 0.176,
  ],
  [
    1983, 361.364, 155.306, 27.693, 56.364, 159.353, 105.055, 34.257, 40.811,
    0.699, 0,
  ],
  [
    1984, 674.964, 659.096, 78.163, 81.867, 215.634, 128.533, 57.427, 42.452,
    1.854, 0,
  ],
  [
    1985, 361.664, 225.023, 122.065, 282.453, 217.936, 177.461, 47.602, 38.399,
    4.156, 0.006,
  ],
  [
    1986, 477.766, 156.198, 127.19, 113.733, 192.833, 177.709, 61.635, 49.451,
    13.675, 0,
  ],
  [
    1987, 413.251, 736.393, 142.106, 149.064, 224.152, 215.672, 54.828, 32.914,
    17.549, 0,
  ],
  [
    1988, 382.197, 189.422, 205.358, 80.655, 225.507, 319.487, 58.049, 57.912,
    17.199, 0,
  ],
  [
    1989, 994.943, 1084.625, 235.931, 247.826, 261.915, 237.46, 53.873, 46.54,
    17.812, 0,
  ],
  [
    1990, 583.854, 327.786, 247.222, 478.49, 235.468, 270.764, 53.902, 55.407,
    19.513, 0.005,
  ],
  [
    1991, 625.782, 490.477, 506.85, 157.388, 332.468, 209.778, 105.355, 82.196,
    24.748, 0.01,
  ],
  [
    1992, 1056.261, 268.413, 845.74, 212.974, 275.57, 269.502, 103.998, 64.241,
    23.662, 0.005,
  ],
  [
    1993, 582.275, 867.729, 413.537, 159.17, 274.965, 175.943, 78.852, 274.219,
    28.611, 0.028,
  ],
  [
    1994, 1081.198, 522.293, 600.238, 198.198, 324.177, 392.18, 86.922, 100.549,
    35.613, 1.279,
  ],
  [
    1995, 468.63, 264.103, 666.303, 229.978, 295.575, 208.161, 92.079, 373.685,
    44.069, 0,
  ],
  [
    1996, 700.291, 412.923, 677.164, 149.282, 305.414, 338.224, 132.661, 58.385,
    49.481, 0.226,
  ],
  [
    1997, 697.805, 1281.841, 468.172, 739.308, 319.589, 337.884, 128.988,
    59.232, 57.107, 4.523,
  ],
  [
    1998, 612.427, 805.67, 535.29, 233.209, 439.736, 399.43, 104.863, 93.805,
    58.055, 1.669,
  ],
  [
    1999, 837.976, 2404.609, 590.555, 307.55, 459.799, 290.096, 123.566, 48.951,
    68.228, 2.64,
  ],
  [
    2000, 837.09, 1359.454, 644.696, 554.332, 506.754, 382.947, 119.01, 46.119,
    81.82, 1.11,
  ],
  [
    2001, 2185.499, 685.032, 1154.792, 527.435, 519.413, 398.79, 210.957,
    85.082, 103.46, 3.053,
  ],
  [
    2002, 1334.403, 1076.581, 975.104, 558.65, 575.633, 405.044, 198.888,
    91.875, 88.269, 18.844,
  ],
  [
    2003, 1005.84, 2131.135, 1081.275, 680.419, 644.9, 546.92, 138.023, 95.014,
    128.18, 18.907,
  ],
  [
    2004, 813.987, 964.031, 916.874, 464.473, 703.747, 661.134, 250.866, 62.698,
    115.988, 2.488,
  ],
  [
    2005, 1075.47, 1160.816, 664.85, 815.538, 605.452, 325.853, 203.03, 137.848,
    106.489, 22.612,
  ],
  [
    2006, 1407.999, 929.619, 1008.23, 484.085, 632.741, 582.267, 245.348,
    86.186, 98.185, 2.45,
  ],
  [
    2007, 1007.665, 762.762, 865.222, 853.802, 563.326, 430.532, 261.369,
    149.66, 114.843, 212.223,
  ],
  [
    2008, 1778.592, 1961.229, 1027.169, 557.701, 718.693, 628.949, 231.61,
    172.08, 126.663, 0.588,
  ],
  [
    2009, 2124.626, 1526.036, 1106.62, 933.554, 931.772, 798.893, 273.688,
    189.538, 134.579, 3.642,
  ],
  [
    2010, 1655.938, 1337.106, 1173.362, 934.851, 816.754, 645.186, 368.686,
    370.781, 167.512, 5.097,
  ],
  [
    2011, 1278.042, 841.037, 1432.733, 829.282, 1077.887, 664.9, 248.094,
    130.204, 164.361, 9.216,
  ],
  [
    2012, 1175.045, 1466.422, 1053.408, 781.419, 578.046, 674.104, 209.513,
    123.219, 146.843, 3.326,
  ],
  [
    2013, 1043.881, 1007.373, 875.086, 1032.108, 759.109, 494.459, 193.212,
    186.249, 201.167, 7.486,
  ],
  [
    2014, 1754.404, 1206.519, 809.296, 801.187, 651.357, 525.352, 240.291,
    262.406, 228.999, 0.975,
  ],
  [
    2015, 1381.97, 653.082, 786.524, 910.896, 660.255, 804.041, 257.835,
    193.733, 193.094, 20.446,
  ],
  [
    2016, 1603.382, 724.33, 1375.831, 1012.869, 984.687, 699.067, 240.013,
    163.178, 287.075, 8.653,
  ],
  [
    2017, 1331.954, 1127.986, 1279.621, 873.295, 933.725, 724.87, 258.798,
    225.245, 236.791, 8.519,
  ],
  [
    2018, 1600.66, 1968.998, 1336.529, 1040.611, 645.903, 672.667, 245.228,
    213.899, 244.032, 65.935,
  ],
  [
    2019, 1110.088, 880.204, 929.312, 1106.07, 625.833, 631.398, 244.673,
    136.035, 284.118, 8.882,
  ],
  [
    2020, 1179.418, 634.83, 846.208, 941.52, 683.435, 757.043, 286.526, 112.957,
    330.975, 30.936,
  ],
  [
    2021, 900.5, 720.227, 926.785, 842.757, 658.226, 731.403, 243.495, 75.048,
    314.724, 7.816,
  ],
];

let dataSet2 = [
  [
    "year",
    "unknow_subject",
    "Computer Science",
    "Engineering",
    "Geology",
    "Biology",
    "Materials Science",
    "Physics",
    "Chemistry",
    "Mathematics",
    "Sociology",
    "Psychology",
    "Economics",
  ],
  [
    1975, 77.061, 65.387, 81.201, 87.058, 91.261, 25.303, 52.625, 33.895,
    23.225, 0, 12.936, 3.563,
  ],
  [
    1976, 20.54, 74.42, 83.218, 1120.185, 85.837, 47.988, 47.696, 43.888,
    28.906, 1.316, 26.514, 1.457,
  ],
  [
    1977, 41.422, 97.531, 93.229, 287.134, 107.304, 108.898, 89.312, 49.986,
    32.591, 2.821, 35.571, 3.867,
  ],
  [
    1978, 43.408, 102.876, 74.575, 239.101, 128.984, 67.728, 158.463, 51.35,
    31.81, 8.067, 29.724, 11.251,
  ],
  [
    1979, 51.615, 101.247, 99.439, 350.288, 131.991, 59.054, 187.609, 88.872,
    29.364, 7.591, 26.893, 10.506,
  ],
  [
    1980, 60.929, 120.289, 111.467, 139.728, 154.053, 89.953, 115.705, 53.797,
    24.839, 21.782, 18.32, 23.856,
  ],
  [
    1981, 36.674, 113.454, 92.631, 220.913, 150.966, 86.324, 152.385, 71.286,
    46.707, 9.178, 16.522, 16.522,
  ],
  [
    1982, 55.715, 51.789, 123.676, 406.947, 146.056, 84.173, 105.374, 67.703,
    31.538, 16.962, 10.832, 21.365,
  ],
  [
    1983, 70.518, 56.364, 105.055, 155.306, 159.353, 104.318, 143.568, 78.616,
    34.862, 17.388, 15.33, 18.927,
  ],
  [
    1984, 123.674, 81.867, 128.533, 659.096, 215.634, 101.158, 442.422, 89.647,
    41.737, 30.396, 23.638, 34.013,
  ],
  [
    1985, 166.346, 282.453, 177.5, 225.023, 217.936, 94.88, 114.719, 99.817,
    52.248, 22.392, 20.427, 27.215,
  ],
  [
    1986, 192.984, 113.733, 177.709, 156.198, 192.833, 129.117, 194.937, 83.509,
    70.203, 31.87, 22.975, 38.99,
  ],
  [
    1987, 216.736, 149.104, 215.672, 736.393, 224.152, 85.787, 159.937, 102.678,
    65.1, 27.783, 19.791, 35.052,
  ],
  [
    1988, 287.276, 80.695, 319.547, 189.422, 225.507, 121.078, 101.998, 94.865,
    64.256, 25.893, 28.334, 29.999,
  ],
  [
    1989, 301.211, 247.866, 237.46, 1084.625, 261.915, 160.267, 672.226, 95.475,
    66.975, 29.131, 20.064, 33.809,
  ],
  [
    1990, 330.176, 478.573, 270.764, 327.786, 235.468, 175.472, 228.856,
    102.509, 77.018, 26.512, 22.387, 31.889,
  ],
  [
    1991, 618.742, 157.388, 209.778, 490.477, 332.468, 151.357, 263.571,
    137.547, 73.397, 53.36, 45.578, 59.907,
  ],
  [
    1992, 935.386, 212.974, 269.502, 268.413, 275.57, 275.07, 539.719, 136.04,
    105.457, 48.429, 33.742, 71.619,
  ],
  [
    1993, 718.767, 159.17, 175.943, 867.729, 274.965, 123.128, 249.958, 128.43,
    80.758, 44.151, 23.004, 55.891,
  ],
  [
    1994, 748.294, 198.198, 392.18, 522.293, 324.177, 196.711, 686.971, 119.617,
    77.9, 49.409, 25.549, 61.373,
  ],
  [
    1995, 1093.642, 229.978, 208.161, 264.103, 295.575, 101.914, 148.278,
    113.723, 105.054, 50.46, 32.893, 59.186,
  ],
  [
    1996, 791.276, 149.282, 338.224, 412.923, 305.414, 298.684, 206.766,
    131.068, 69.774, 64.003, 57.054, 75.608,
  ],
  [
    1997, 590.471, 739.308, 337.884, 1281.841, 319.589, 114.283, 354.363,
    122.342, 106.818, 61.802, 38.687, 90.301,
  ],
  [
    1998, 690.695, 233.209, 399.43, 805.67, 439.736, 221.471, 140.738, 152.024,
    99.866, 59.531, 37.825, 67.038,
  ],
  [
    1999, 710.946, 307.55, 290.096, 2404.609, 459.799, 124.855, 406.159,
    169.707, 138.013, 60.957, 59.25, 64.316,
  ],
  [
    2000, 778.559, 554.332, 382.947, 1359.454, 506.754, 288.267, 205.629,
    160.917, 182.278, 53.63, 53.213, 65.798,
  ],
  [
    2001, 1346.857, 527.435, 398.79, 685.032, 519.413, 368.107, 1506.404,
    189.335, 121.899, 104.87, 74.559, 136.399,
  ],
  [
    2002, 1174.115, 558.65, 405.044, 1076.581, 575.633, 326.103, 638.843,
    183.249, 190.475, 68.666, 57.594, 141.294,
  ],
  [
    2003, 1329.457, 680.419, 546.92, 2131.135, 644.9, 268.023, 405.343, 190.451,
    155.377, 72.166, 62.875, 77.34,
  ],
  [
    2004, 1100.633, 464.473, 661.284, 968.684, 703.747, 198.8, 237.84, 204.501,
    182.676, 173.056, 106.097, 166.309,
  ],
  [
    2005, 955.811, 815.538, 325.853, 1160.816, 605.452, 318.94, 334.673,
    187.999, 234.027, 122.421, 81.949, 126.284,
  ],
  [
    2006, 1204.197, 484.085, 582.267, 929.619, 632.741, 248.669, 754.974,
    212.096, 193.82, 143.423, 112.078, 150.446,
  ],
  [
    2007, 1345.91, 853.802, 430.532, 762.762, 563.326, 158.366, 399.736,
    203.955, 255.809, 115.349, 106.362, 162.392,
  ],
  [
    2008, 1330.706, 557.701, 628.949, 1961.83, 718.693, 486.664, 878.005,
    209.809, 223.687, 93.145, 117.048, 126.412,
  ],
  [
    2009, 1442.533, 933.554, 798.893, 1526.036, 931.772, 300.615, 1231.65,
    321.623, 270.739, 136.463, 138.602, 144.038,
  ],
  [
    2010, 1720.105, 934.851, 645.186, 1337.106, 816.754, 337.843, 718.748,
    271.865, 327.482, 230.424, 109.706, 190.042,
  ],
  [
    2011, 1741.951, 829.282, 664.9, 841.037, 1077.887, 315.614, 537.735,
    207.458, 217.234, 154, 71.493, 118.182,
  ],
  [
    2012, 1330.631, 781.419, 674.104, 1466.422, 578.046, 205.996, 442.163,
    253.978, 272.907, 84.793, 88.251, 105.249,
  ],
  [
    2013, 1276.244, 1032.108, 494.459, 1007.409, 759.109, 385.474, 217.944,
    240.03, 200.433, 115.826, 70.889, 92.811,
  ],
  [
    2014, 1306.304, 801.187, 525.352, 1206.557, 651.357, 486.55, 815.844,
    243.091, 208.919, 134.077, 79.91, 132.02,
  ],
  [
    2015, 1195.096, 910.896, 804.041, 653.082, 660.255, 233.854, 588.52,
    272.051, 287.683, 160.652, 86.002, 135.071,
  ],
  [
    2016, 1841.199, 1012.869, 699.067, 724.33, 984.687, 269.225, 913.178,
    217.641, 208.733, 125.153, 94.927, 109.92,
  ],
  [
    2017, 1751.069, 873.295, 724.87, 1127.986, 933.725, 319.537, 563.023,
    236.142, 217.023, 137.018, 95.361, 136,
  ],
  [
    2018, 1869.665, 1040.611, 672.667, 1968.998, 645.903, 392.308, 731.548,
    257.662, 219.142, 112.036, 104.445, 116.809,
  ],
  [
    2019, 1361.894, 1106.07, 631.398, 880.204, 625.833, 302.358, 363.799,
    306.882, 235.266, 131.084, 98.16, 127.47,
  ],
  [
    2020, 1323.34, 941.52, 757.043, 634.83, 683.435, 307.893, 401.117, 309.244,
    296.117, 138.629, 111.975, 154.632,
  ],
  [
    2021, 1327.024, 842.757, 731.403, 720.227, 658.226, 269.688, 256.178,
    255.167, 213.611, 126.088, 111.093, 109.487,
  ],
];

let dataSet3 = [
  [
    "year",
    "unknow_subject",
    "Computer Science",
    "Geology",
    "Engineering",
    "Biology",
    "Mathematics",
    "Physics",
    "Chemistry",
    "Materials Science",
    "Sociology",
    "Psychology",
    "Economics",
  ],
  [1975, 1805, 1440, 627, 703, 1015, 475, 323, 379, 331, 0, 275, 14],
  [1976, 447, 1676, 802, 792, 1211, 683, 403, 496, 478, 21, 384, 16],
  [1977, 544, 2168, 938, 875, 1361, 618, 553, 551, 584, 13, 430, 24],
  [1978, 537, 2108, 1103, 727, 1412, 653, 482, 503, 515, 31, 462, 37],
  [1979, 637, 1988, 909, 968, 1432, 545, 346, 409, 360, 65, 454, 78],
  [1980, 877, 1937, 924, 1057, 1325, 493, 309, 313, 339, 232, 291, 244],
  [1981, 742, 1690, 959, 844, 1322, 531, 294, 404, 334, 140, 251, 161],
  [1982, 954, 332, 952, 970, 1286, 451, 304, 336, 255, 207, 204, 220],
  [1983, 967, 317, 975, 992, 1387, 530, 371, 356, 303, 265, 263, 269],
  [1984, 1304, 359, 1150, 1154, 1616, 537, 388, 407, 277, 290, 285, 308],
  [1985, 1701, 397, 1115, 1283, 1584, 629, 371, 412, 304, 296, 272, 319],
  [1986, 1712, 330, 976, 973, 1385, 695, 346, 351, 254, 268, 273, 295],
  [1987, 1820, 463, 1162, 1240, 1474, 678, 344, 435, 276, 271, 286, 293],
  [1988, 2053, 457, 1075, 1175, 1354, 728, 327, 378, 279, 268, 248, 284],
  [1989, 2265, 508, 1077, 1095, 1516, 733, 423, 406, 287, 287, 303, 307],
  [1990, 2374, 646, 1301, 1222, 1523, 707, 405, 458, 342, 328, 319, 346],
  [1991, 2926, 746, 1555, 1290, 1482, 816, 412, 474, 384, 363, 304, 379],
  [1992, 2989, 792, 1456, 1272, 1367, 775, 406, 426, 422, 486, 345, 506],
  [1993, 2568, 712, 1362, 1080, 1356, 675, 326, 451, 394, 413, 312, 428],
  [1994, 2614, 781, 1505, 1329, 1427, 774, 392, 432, 424, 416, 305, 433],
  [1995, 2541, 746, 1294, 1092, 1423, 743, 348, 446, 391, 446, 333, 464],
  [1996, 2390, 664, 1474, 1073, 1382, 729, 318, 395, 379, 368, 343, 388],
  [1997, 2214, 792, 1626, 1257, 1428, 742, 408, 470, 418, 454, 356, 477],
  [1998, 2109, 762, 1470, 1164, 1483, 710, 391, 416, 449, 551, 394, 560],
  [1999, 1685, 840, 1608, 1160, 1437, 757, 371, 397, 444, 479, 409, 498],
  [2000, 1764, 1004, 1740, 1292, 1520, 798, 443, 413, 504, 525, 412, 542],
  [2001, 1947, 1001, 1671, 1184, 1531, 728, 466, 454, 447, 523, 456, 546],
  [2002, 1964, 1153, 1816, 1371, 1466, 879, 449, 453, 427, 553, 401, 572],
  [2003, 2095, 1318, 1845, 1521, 1510, 765, 537, 508, 586, 509, 418, 514],
  [2004, 1896, 1104, 1774, 1320, 1531, 908, 488, 478, 453, 529, 447, 539],
  [2005, 1579, 1213, 1716, 1229, 1396, 921, 459, 447, 393, 566, 494, 579],
  [2006, 1690, 1316, 1739, 1382, 1297, 931, 534, 457, 392, 627, 525, 636],
  [2007, 1987, 1769, 1772, 1514, 1377, 1047, 563, 456, 449, 574, 632, 592],
  [2008, 2028, 1537, 1698, 1582, 1333, 997, 507, 453, 443, 556, 656, 564],
  [2009, 2253, 1987, 2231, 2236, 1883, 1170, 839, 646, 596, 681, 753, 679],
  [2010, 2419, 1809, 2083, 1838, 1583, 1012, 614, 603, 544, 672, 652, 633],
  [2011, 1944, 1598, 1770, 1726, 1433, 1034, 518, 459, 423, 559, 481, 508],
  [2012, 1939, 1810, 1732, 1788, 1323, 1028, 597, 531, 497, 513, 536, 462],
  [2013, 1958, 1741, 1652, 1732, 1323, 906, 512, 479, 425, 497, 466, 418],
  [2014, 1983, 1796, 1547, 1770, 1329, 975, 549, 486, 493, 563, 478, 490],
  [2015, 2047, 2070, 1631, 1955, 1426, 1010, 627, 548, 517, 550, 536, 453],
  [2016, 2429, 2072, 1614, 1839, 1425, 990, 593, 510, 496, 528, 509, 425],
  [2017, 1988, 2015, 1540, 1857, 1235, 1001, 523, 501, 463, 577, 505, 448],
  [2018, 2042, 2166, 1503, 1927, 1253, 1086, 609, 564, 484, 474, 508, 397],
  [2019, 2057, 2202, 1573, 1758, 1057, 1069, 556, 550, 523, 467, 435, 396],
  [2020, 2242, 2121, 1617, 1726, 1368, 1002, 598, 546, 510, 600, 505, 517],
  [2021, 2333, 1894, 1711, 1631, 1265, 900, 600, 554, 531, 464, 453, 367],
];

let dataSet4 = [
  [
    "year",
    "Computer network",
    "Earth science",
    "Biological system",
    "Civil Engineering",
    "Manufacturing engineering",
    "Mechanical Engineering",
    "Chemical Engineering",
    "Biochemical engineering",
    "Transport engineering",
    "Artificial intelligence",
    "Computer Engineering",
    "Oceanography",
    "Ecology",
    "Cell biology",
    "Molecular biology",
    "Atmospheric sciences",
    "Telecommunications",
    "Electrical engineering",
    "Astronomy",
    "Engineering Management",
    "Computer hardware",
    "Information retrieval",
    "Neuroscience",
    "Cognitive science",
    "Nanotechnology",
    "Socioeconomics",
  ],
  [
    1960, 0.125, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.125, 0, 0, 0, 0,
    0, 0, 0, 0, 0,
  ],
  [
    1961, 0.049, 0, 0, 0, 0, 0, 0, 0, 0, 0.396, 0.04, 0, 0, 0, 0, 0, 0.049, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    1962, 1.335, 0, 0, 0, 0, 0, 0, 0, 0, 0.535, 0, 0, 0, 0, 0, 0, 1.335, 0, 0,
    0, 0, 0, 0, 0, 0, 0,
  ],
  [
    1963, 4.286, 0, 0, 0, 0, 0, 0, 0, 0, 0.276, 0, 0, 0, 0, 0, 2.305, 4.286, 0,
    0.412, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    1964, 2.508, 0.071, 0, 0, 0, 0, 0, 0, 0, 0.168, 0, 0.02, 0, 0, 0, 0, 2.508,
    0, 0, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    1965, 5.091, 0.065, 0, 0, 0, 0, 0, 0, 0, 0.634, 0, 0, 0, 0, 0, 0, 0.124, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    1966, 0.011, 0.042, 0, 0, 0, 0, 0, 0, 0, 0.365, 0.006, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    1967, 1.339, 2.824, 1.518, 0, 0, 0, 0, 0, 0, 17.46, 0.014, 0.059, 1.518, 0,
    0, 220.894, 1.339, 0, 22.217, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    1968, 0.263, 0.89, 0.699, 0, 0, 0, 0, 0, 0, 2.637, 0.172, 0.077, 0.689, 0.1,
    0.1, 0, 0.263, 0, 81.099, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    1969, 3.204, 0.54, 0.483, 0, 0, 0, 0, 0, 0, 9.098, 0.386, 0.06, 0.328, 0, 0,
    0.121, 3.204, 0, 48.22, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    1970, 6.647, 10.529, 5.279, 0, 0, 0, 0, 0, 0, 3.925, 0.216, 2.581, 4.544,
    1.376, 1.376, 1.573, 6.632, 0, 2.134, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    1971, 5.384, 7.53, 6.463, 0.888, 0.888, 0.888, 1.266, 1.266, 1.266, 6.369,
    0.312, 30.963, 3.646, 5.459, 5.459, 59.02, 5.255, 0, 3.517, 0, 0, 0, 0.04,
    0, 0, 0,
  ],
  [
    1972, 20.744, 26.465, 19.034, 9.002, 9.002, 9.002, 21.493, 21.493, 21.493,
    10.169, 1.016, 46.678, 13.61, 7.89, 7.89, 8.715, 20.697, 0.182, 73.618, 0,
    0.159, 0, 1.559, 0, 0, 0,
  ],
  [
    1973, 2.609, 23.202, 13.861, 6.576, 6.576, 6.576, 10.379, 10.379, 10.379,
    6.185, 2.874, 13.084, 6.574, 10.533, 10.533, 7.413, 2.248, 1.387, 3.2, 0,
    0.957, 0, 1.115, 0, 0, 0,
  ],
  [
    1974, 28.91, 36.636, 29.089, 13.221, 13.221, 13.221, 21.876, 21.876, 21.876,
    12.441, 13.767, 38.241, 17.567, 23.706, 23.706, 12.171, 16.978, 3.685,
    136.993, 0.103, 1.337, 0, 4.268, 0, 0, 0,
  ],
  [
    1975, 31.858, 34.15, 50.946, 16.212, 16.212, 16.212, 25.637, 25.637, 25.637,
    12.31, 18.203, 30.242, 34.377, 30.392, 30.392, 22.666, 15.067, 4.161,
    12.371, 0.405, 3.015, 0, 7.409, 0, 0, 0,
  ],
  [
    1976, 12.992, 1016.245, 38.873, 16.191, 16.191, 16.191, 38.717, 38.717,
    38.717, 3.643, 54.841, 44.696, 20.269, 34.037, 34.037, 59.244, 12.992,
    6.892, 9.161, 4.354, 2.944, 0, 10.115, 0, 0, 0,
  ],
  [
    1977, 15.43, 22.582, 54.511, 19.024, 19.024, 19.024, 37.949, 37.949, 37.949,
    3.822, 75.944, 49.907, 28.435, 41.664, 41.664, 214.645, 15.43, 5.284,
    17.701, 2.739, 2.334, 0, 7.383, 0.126, 0, 0,
  ],
  [
    1978, 20.936, 76.84, 63.304, 15.038, 15.038, 15.038, 42.604, 42.604, 42.604,
    4.498, 71.696, 122.716, 37.205, 43.914, 43.914, 39.545, 20.936, 7.267,
    85.219, 4.137, 5.507, 0, 7.072, 0, 0, 0,
  ],
  [
    1979, 17.998, 274.8, 61.855, 27.406, 27.406, 27.406, 46.096, 46.096, 46.096,
    4.212, 74.621, 47.002, 33.927, 54.133, 54.133, 28.486, 17.998, 16.223,
    122.449, 4.354, 4.416, 0, 10.644, 0, 0, 0,
  ],
  [
    1980, 25.029, 34.758, 87.153, 39.362, 39.362, 39.362, 41.446, 41.446,
    41.446, 5.1, 83.508, 61.734, 56.639, 52.94, 52.94, 43.235, 25.029, 15.706,
    20.395, 6.298, 6.651, 0, 9.081, 0, 0, 0,
  ],
  [
    1981, 33.313, 22.6, 77.449, 32.111, 32.111, 32.111, 31.994, 31.994, 31.994,
    5.697, 67.839, 153.623, 48.666, 56.308, 50.652, 44.689, 33.313, 18.445,
    53.178, 4.296, 6.605, 0, 10.791, 0, 0, 0,
  ],
  [
    1982, 35.688, 39.308, 64.598, 40.02, 40.02, 40.02, 41.133, 41.133, 41.133,
    6.005, 0.703, 49.862, 38.874, 63.158, 56.568, 317.777, 35.688, 30.295,
    26.61, 1.214, 9.392, 0, 11.358, 0, 0, 0,
  ],
  [
    1983, 37.437, 48.585, 70.894, 34.571, 34.571, 34.571, 37.817, 37.817,
    37.817, 7.403, 0.21, 62.486, 41.385, 70.277, 64.659, 44.236, 37.437, 22.175,
    33.979, 1.651, 11.314, 0, 10.763, 0, 0, 0,
  ],
  [
    1984, 42.496, 51.709, 108.518, 40.609, 40.609, 40.609, 46.809, 46.809,
    46.809, 11.049, 18.978, 549.654, 56.79, 92.079, 81.552, 57.733, 42.496,
    22.409, 293.382, 3.901, 9.343, 0, 3.78, 0, 0, 0,
  ],
  [
    1985, 42.803, 89.827, 113.054, 55.386, 55.386, 55.386, 47.908, 47.908,
    47.908, 10.475, 223.881, 80.181, 58.537, 88.784, 78.349, 55.015, 42.803,
    21.64, 29.137, 1.271, 5.294, 0, 0, 0, 0, 0.04,
  ],
  [
    1986, 46.283, 44.567, 110.535, 76.657, 76.657, 76.657, 39.716, 39.716,
    39.716, 10.487, 54.66, 65.08, 67.432, 68.039, 61.867, 46.551, 44.967, 25.87,
    58.612, 0.015, 2.303, 0, 0.022, 0, 0, 0,
  ],
  [
    1987, 110.042, 49.463, 120.503, 61.696, 61.696, 61.696, 49.08, 49.08, 49.08,
    16.848, 21.801, 199.626, 67.332, 71.155, 63.537, 487.304, 42.736, 53.675,
    21.294, 2, 0.413, 0, 0, 0, 0, 0,
  ],
  [
    1988, 34.389, 49.753, 108.946, 45.705, 45.705, 45.705, 39.856, 39.856,
    39.856, 18.681, 26.605, 85.353, 62.291, 74.344, 67.567, 54.316, 30.217,
    30.707, 30.657, 0.034, 1.019, 0, 0, 0, 0, 0,
  ],
  [
    1989, 73.681, 951.905, 120.598, 56.307, 56.307, 56.307, 51.131, 51.131,
    51.131, 22.747, 150.188, 81.151, 60.44, 82.785, 82.785, 51.569, 31.571,
    29.466, 563.136, 0, 1.25, 0, 0, 0, 0, 0,
  ],
  [
    1990, 53.668, 77.689, 117.784, 49.965, 49.965, 49.965, 51.841, 51.841,
    51.841, 22.612, 399.507, 191.045, 58.204, 70.728, 70.389, 59.052, 36.433,
    24.683, 32.461, 0, 2.786, 0, 0, 0, 0, 0,
  ],
  [
    1991, 93.402, 252.558, 175.305, 85.349, 85.349, 85.349, 51.73, 51.73, 51.73,
    25.823, 37.404, 152.524, 90.03, 108.191, 108.191, 85.395, 44.268, 35.491,
    143.866, 0, 0.759, 0, 0, 0, 0, 0,
  ],
  [
    1992, 93.334, 85.831, 163.83, 76.788, 76.788, 76.788, 68.679, 68.679,
    68.679, 40.634, 77.075, 108.094, 93.984, 73.861, 73.861, 74.488, 61.579,
    41.936, 53.819, 0, 1.931, 0, 0, 0, 0, 0,
  ],
  [
    1993, 83.652, 152.241, 127.974, 54.63, 54.63, 54.63, 51.708, 51.708, 51.708,
    31.656, 43.592, 246.705, 62.727, 77.073, 77.023, 468.783, 40.32, 28.816,
    43.107, 0.798, 0.27, 0, 0, 0, 0, 0,
  ],
  [
    1994, 86.699, 153.947, 160.34, 111.249, 111.249, 111.249, 66.643, 66.643,
    66.643, 54.269, 57.23, 204.884, 72.838, 92.309, 92.309, 163.463, 48.789,
    55.149, 564.847, 1.566, 0, 0, 0, 0, 0, 0,
  ],
  [
    1995, 85.179, 94.818, 152.364, 70.285, 70.285, 70.285, 62.138, 62.138,
    62.138, 30.925, 113.874, 88.32, 76.139, 79.64, 79.64, 80.966, 54.39, 42.426,
    30.726, 1.284, 0, 0, 0, 0, 0, 0,
  ],
  [
    1996, 77.623, 190.32, 147.846, 85.017, 85.017, 85.017, 61.922, 61.922,
    61.922, 27.712, 43.946, 162.368, 68.634, 74.467, 74.467, 60.235, 44.277,
    34.508, 41.021, 0.658, 0, 0, 0, 0, 0, 0,
  ],
  [
    1997, 126.668, 979.989, 175.012, 85.109, 85.109, 85.109, 74.861, 74.861,
    74.861, 54.025, 558.616, 210.867, 85.097, 86.394, 86.394, 90.985, 57.548,
    46.24, 235.232, 1.046, 0, 0, 0, 0, 0, 0,
  ],
  [
    1998, 135.618, 135.012, 270.09, 81.109, 81.109, 81.109, 77.466, 77.466,
    77.466, 42.906, 54.685, 139.287, 80.198, 99.788, 99.788, 531.371, 53.413,
    38.449, 38.242, 1.227, 0, 0, 0, 0, 0, 0,
  ],
  [
    1999, 164.301, 2088.835, 255.742, 87.848, 87.848, 87.848, 72.725, 72.725,
    72.725, 98.161, 45.088, 128.617, 85.482, 113.552, 113.552, 187.157, 75.483,
    74.088, 137.5, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2000, 289.217, 411.832, 299.984, 99.637, 99.637, 99.637, 97.458, 97.458,
    97.458, 153.45, 111.665, 771.553, 149.959, 122.018, 122.018, 176.069,
    182.398, 84.351, 61.805, 0.294, 0, 0, 0, 0, 0, 0,
  ],
  [
    2001, 281.342, 412.059, 298.428, 149.612, 149.612, 149.612, 114.797,
    114.797, 114.797, 135.864, 110.23, 169.304, 104.271, 136.501, 136.501,
    103.669, 171.348, 61.273, 986.116, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2002, 376.421, 549.926, 326.21, 124.945, 124.945, 124.945, 139.779, 139.779,
    139.779, 141.536, 40.692, 345.81, 133.125, 131.739, 131.739, 180.845,
    186.078, 80.189, 456.383, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2003, 395.393, 495.865, 336.857, 162.489, 162.489, 162.489, 120.124,
    120.124, 120.124, 237.413, 47.614, 879.388, 123.497, 131.148, 131.148,
    755.882, 174.283, 81.579, 127.817, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2004, 276.78, 325.999, 333.542, 217.759, 217.759, 217.759, 116.418, 116.418,
    116.418, 138.103, 49.591, 479.672, 135.038, 137.6, 137.6, 163.013, 100.719,
    242.459, 83.642, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2005, 286.27, 481.57, 330.951, 119.723, 119.723, 119.723, 110.939, 110.939,
    110.939, 121.61, 407.658, 545.202, 143.699, 141.441, 141.441, 134.044,
    122.957, 63.956, 172.446, 0.359, 0, 0, 0, 0, 0, 0,
  ],
  [
    2006, 298.518, 506.307, 328.388, 142.587, 142.587, 142.587, 110.126,
    110.126, 110.126, 106.602, 78.964, 258.26, 147.55, 135.531, 135.531,
    165.051, 105.581, 72.701, 430.074, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2007, 338.216, 395.556, 324.107, 143.503, 143.503, 143.503, 127.001,
    127.001, 127.001, 141.957, 373.628, 240.145, 120.629, 130.629, 130.629,
    127.061, 119.894, 77.6, 146.619, 0, 0, 0, 0, 0, 0.35, 0,
  ],
  [
    2008, 382.423, 419.028, 324.606, 165.877, 165.877, 165.877, 133.21, 133.21,
    133.21, 140.348, 34.93, 210.585, 152.399, 109.803, 109.803, 1332.218,
    168.203, 83.045, 84.06, 0.02, 0, 0, 0, 0, 0, 0,
  ],
  [
    2009, 519.999, 425.182, 488.78, 313.852, 313.852, 313.852, 206.837, 206.837,
    206.837, 237.67, 175.884, 847.32, 196.359, 197.458, 197.458, 253.533,
    201.323, 125.655, 936.939, 0.062, 0, 0, 0, 0.058, 0, 0,
  ],
  [
    2010, 566.508, 510.333, 425.547, 185.196, 185.196, 185.196, 213.017,
    213.017, 213.017, 179.454, 188.888, 641.767, 160.392, 166.721, 166.721,
    185.006, 220.033, 140.049, 520.524, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2011, 397.873, 495.978, 371.687, 182.394, 182.394, 182.394, 161.015,
    161.015, 161.015, 172.984, 257.408, 181.494, 159.097, 170.616, 170.616,
    163.565, 149.678, 100.198, 171.061, 0, 0, 1.017, 0, 0, 0, 0,
  ],
  [
    2012, 451.478, 709.667, 331.304, 171.227, 171.227, 171.227, 184.455,
    184.455, 184.455, 220.264, 109.677, 585.295, 151.86, 122.923, 122.923,
    171.46, 162.028, 93.961, 104.255, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2013, 490.224, 632.79, 345.629, 170.732, 170.732, 170.732, 172.398, 172.398,
    172.398, 212.212, 329.146, 247.627, 154.617, 148.063, 148.063, 126.992,
    219.923, 83.018, 74.211, 0, 0, 0.527, 0, 0, 0, 0,
  ],
  [
    2014, 452.131, 378.128, 369.616, 170.464, 170.464, 170.464, 178.022,
    178.022, 178.022, 198.102, 150.94, 673.379, 165.393, 98.978, 98.978,
    155.049, 161.423, 83.883, 564.066, 0, 0, 0.014, 0, 0, 1.133, 0,
  ],
  [
    2015, 539.825, 276.971, 430.014, 223.39, 223.39, 223.39, 208.425, 208.425,
    208.425, 186.378, 184.678, 220.572, 172.883, 117.849, 117.849, 155.539,
    198.131, 191.689, 379.44, 0, 0, 0.015, 0, 0, 0.444, 0,
  ],
  [
    2016, 439.459, 356.073, 441.866, 298.422, 298.422, 298.422, 182.663,
    182.663, 182.663, 232.889, 340.521, 255.807, 169.354, 150.739, 150.739,
    112.45, 171.168, 114.714, 603.86, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2017, 516.514, 459.505, 326.865, 209.017, 209.017, 209.017, 197.156,
    197.156, 197.156, 207.157, 149.624, 551.396, 159.355, 121.916, 121.916,
    117.085, 173.342, 116.129, 268.426, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2018, 561.243, 681.061, 372.301, 233.773, 233.773, 233.773, 202.444,
    202.444, 202.444, 236.141, 242.093, 721.802, 173.005, 147.522, 147.522,
    566.134, 189.566, 132.296, 278.824, 0, 0, 1.134, 0, 0, 2.174, 0,
  ],
  [
    2019, 509.265, 451.149, 336.867, 224.394, 224.394, 224.394, 211.035,
    211.035, 211.035, 276.806, 320, 215.401, 170.027, 118.859, 118.859, 213.654,
    203.351, 118.533, 156.116, 0.997, 0, 0, 0, 0, 0.013, 0,
  ],
  [
    2020, 476.239, 325.878, 366.1, 237.882, 237.882, 237.882, 211.304, 211.304,
    211.304, 199.559, 264.099, 172.56, 170.584, 135.179, 135.179, 136.393,
    197.877, 194.253, 129.972, 0.335, 0, 1.623, 0, 0, 0, 0,
  ],
  [
    2021, 469.194, 392.168, 319.113, 268.97, 268.97, 268.97, 223.217, 223.217,
    223.217, 192.026, 181.537, 181.059, 156.33, 150.904, 150.904, 146.999,
    135.813, 131.863, 98.88, 0.23, 0, 0, 0, 0, 0, 0,
  ],
];

let dataSet5 = [
  [
    "year",
    "Computer network",
    "Earth science",
    "Biological system",
    "Civil Engineering",
    "Manufacturing engineering",
    "Mechanical Engineering",
    "Chemical Engineering",
    "Biochemical engineering",
    "Transport engineering",
    "Artificial intelligence",
    "Oceanography",
    "Telecommunications",
    "Ecology",
    "Electrical engineering",
    "Atmospheric sciences",
    "Cell biology",
    "Molecular biology",
    "Astronomy",
    "Computer Engineering",
    "Engineering Management",
    "Computer hardware",
    "Information retrieval",
    "Neuroscience",
    "Cognitive science",
    "Nanotechnology",
    "Socioeconomics",
  ],
  [
    1960, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0,
  ],
  [
    1961, 1, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
    0, 0, 0,
  ],
  [
    1962, 3, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0,
  ],
  [
    1963, 3, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 3, 0, 0, 1, 0, 0, 2, 0, 0, 0, 0, 0,
    0, 0, 0,
  ],
  [
    1964, 2, 2, 0, 0, 0, 0, 0, 0, 0, 3, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0,
  ],
  [
    1965, 3, 3, 0, 0, 0, 0, 0, 0, 0, 3, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0,
  ],
  [
    1966, 1, 1, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
    0, 0, 0,
  ],
  [
    1967, 2, 3, 1, 0, 0, 0, 0, 0, 0, 22, 1, 2, 1, 0, 2, 0, 0, 3, 1, 0, 0, 0, 0,
    0, 0, 0,
  ],
  [
    1968, 2, 3, 3, 0, 0, 0, 0, 0, 0, 15, 2, 2, 2, 0, 0, 1, 1, 2, 5, 0, 0, 0, 0,
    0, 0, 0,
  ],
  [
    1969, 11, 5, 5, 0, 0, 0, 0, 0, 0, 30, 1, 11, 3, 0, 4, 0, 0, 5, 5, 0, 0, 0,
    0, 0, 0, 0,
  ],
  [
    1970, 23, 20, 23, 0, 0, 0, 0, 0, 0, 36, 6, 22, 15, 0, 10, 15, 15, 31, 7, 0,
    0, 0, 0, 0, 0, 0,
  ],
  [
    1971, 27, 46, 65, 1, 1, 1, 5, 5, 5, 46, 34, 25, 35, 0, 20, 60, 60, 29, 6, 0,
    0, 0, 2, 0, 0, 0,
  ],
  [
    1972, 94, 64, 152, 12, 12, 12, 42, 42, 42, 76, 81, 91, 94, 2, 45, 106, 106,
    18, 7, 0, 5, 0, 25, 0, 0, 0,
  ],
  [
    1973, 46, 100, 182, 31, 31, 31, 77, 77, 77, 41, 64, 39, 84, 15, 52, 125,
    125, 28, 27, 0, 7, 0, 16, 0, 0, 0,
  ],
  [
    1974, 314, 182, 320, 45, 45, 45, 170, 170, 170, 110, 165, 190, 148, 32, 104,
    279, 279, 57, 203, 1, 20, 0, 60, 0, 0, 0,
  ],
  [
    1975, 534, 198, 497, 83, 83, 83, 296, 296, 296, 184, 245, 258, 261, 71, 184,
    356, 356, 87, 677, 6, 45, 0, 89, 0, 0, 0,
  ],
  [
    1976, 158, 268, 628, 103, 103, 103, 351, 351, 351, 51, 350, 158, 332, 105,
    184, 415, 415, 115, 1417, 60, 50, 0, 93, 0, 0, 0,
  ],
  [
    1977, 188, 295, 702, 112, 112, 112, 419, 419, 419, 35, 389, 188, 349, 104,
    254, 472, 472, 156, 1905, 47, 40, 0, 96, 1, 0, 0,
  ],
  [
    1978, 188, 400, 696, 81, 81, 81, 394, 394, 394, 46, 426, 188, 398, 100, 277,
    500, 500, 144, 1815, 47, 57, 0, 96, 0, 0, 0,
  ],
  [
    1979, 177, 365, 726, 221, 221, 221, 452, 452, 452, 38, 324, 177, 404, 170,
    220, 498, 498, 150, 1728, 47, 45, 0, 109, 0, 0, 0,
  ],
  [
    1980, 169, 361, 717, 401, 401, 401, 381, 381, 381, 49, 307, 169, 414, 159,
    256, 431, 431, 141, 1655, 60, 64, 0, 76, 0, 0, 0,
  ],
  [
    1981, 153, 292, 657, 271, 271, 271, 279, 279, 279, 49, 431, 153, 401, 182,
    236, 461, 413, 113, 1418, 53, 70, 0, 84, 0, 0, 0,
  ],
  [
    1982, 168, 405, 600, 315, 315, 315, 363, 363, 363, 53, 317, 168, 362, 184,
    230, 456, 411, 127, 9, 32, 102, 0, 95, 0, 0, 0,
  ],
  [
    1983, 172, 356, 653, 329, 329, 329, 358, 358, 358, 53, 366, 172, 409, 192,
    253, 503, 458, 156, 5, 27, 87, 0, 86, 0, 0, 0,
  ],
  [
    1984, 180, 448, 853, 366, 366, 366, 449, 449, 449, 90, 408, 180, 465, 185,
    294, 568, 502, 152, 5, 54, 84, 0, 18, 0, 0, 0,
  ],
  [
    1985, 217, 421, 887, 499, 499, 499, 420, 420, 420, 80, 431, 217, 463, 313,
    263, 531, 469, 149, 33, 12, 67, 0, 0, 0, 0, 1,
  ],
  [
    1986, 190, 373, 819, 413, 413, 413, 333, 333, 333, 81, 340, 188, 454, 187,
    263, 393, 350, 119, 28, 1, 31, 0, 1, 0, 0, 0,
  ],
  [
    1987, 287, 442, 796, 515, 515, 515, 419, 419, 419, 113, 462, 231, 421, 216,
    258, 403, 358, 125, 60, 2, 3, 0, 0, 0, 0, 0,
  ],
  [
    1988, 259, 471, 714, 405, 405, 405, 372, 372, 372, 119, 352, 233, 397, 232,
    252, 411, 368, 130, 75, 1, 4, 0, 0, 0, 0, 0,
  ],
  [
    1989, 279, 480, 776, 431, 431, 431, 381, 381, 381, 135, 368, 236, 394, 208,
    229, 422, 422, 148, 91, 0, 3, 0, 0, 0, 0, 0,
  ],
  [
    1990, 344, 589, 808, 486, 486, 486, 394, 394, 394, 143, 457, 275, 412, 201,
    255, 381, 379, 137, 152, 0, 7, 0, 0, 0, 0, 0,
  ],
  [
    1991, 414, 613, 836, 549, 549, 549, 374, 374, 374, 173, 572, 335, 448, 244,
    370, 375, 375, 157, 149, 0, 10, 0, 0, 0, 0, 0,
  ],
  [
    1992, 464, 698, 848, 543, 543, 543, 400, 400, 400, 173, 460, 343, 399, 233,
    298, 349, 349, 141, 144, 0, 11, 0, 0, 0, 0, 0,
  ],
  [
    1993, 420, 639, 783, 420, 420, 420, 338, 338, 338, 166, 444, 270, 386, 207,
    279, 356, 355, 127, 125, 3, 1, 0, 0, 0, 0, 0,
  ],
  [
    1994, 492, 736, 807, 552, 552, 552, 418, 418, 418, 143, 476, 288, 380, 230,
    293, 355, 355, 165, 146, 7, 0, 0, 0, 0, 0, 0,
  ],
  [
    1995, 444, 591, 794, 402, 402, 402, 369, 369, 369, 147, 376, 320, 376, 226,
    327, 344, 344, 112, 155, 4, 0, 0, 0, 0, 0, 0,
  ],
  [
    1996, 381, 710, 733, 434, 434, 434, 330, 330, 330, 133, 433, 267, 322, 206,
    331, 333, 333, 116, 150, 4, 0, 0, 0, 0, 0, 0,
  ],
  [
    1997, 445, 824, 821, 464, 464, 464, 437, 437, 437, 181, 459, 293, 345, 230,
    343, 358, 358, 157, 166, 3, 0, 0, 0, 0, 0, 0,
  ],
  [
    1998, 426, 720, 843, 423, 423, 423, 416, 416, 416, 169, 458, 269, 343, 181,
    292, 383, 383, 140, 167, 6, 0, 0, 0, 0, 0, 0,
  ],
  [
    1999, 529, 783, 776, 432, 432, 432, 372, 372, 372, 203, 452, 338, 346, 251,
    373, 383, 383, 143, 108, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2000, 635, 831, 881, 518, 518, 518, 450, 450, 450, 282, 524, 416, 427, 230,
    385, 374, 374, 163, 87, 1, 0, 0, 0, 0, 0, 0,
  ],
  [
    2001, 674, 851, 838, 440, 440, 440, 407, 407, 407, 262, 488, 401, 394, 243,
    332, 374, 374, 187, 65, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2002, 803, 965, 826, 500, 500, 500, 413, 413, 413, 292, 483, 400, 414, 301,
    368, 312, 312, 208, 58, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2003, 831, 927, 803, 589, 589, 589, 431, 431, 431, 427, 511, 465, 400, 281,
    407, 344, 344, 203, 60, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2004, 730, 904, 837, 514, 514, 514, 417, 417, 417, 322, 479, 335, 434, 239,
    391, 335, 335, 208, 52, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2005, 768, 946, 816, 495, 495, 495, 377, 377, 377, 355, 434, 322, 477, 242,
    336, 282, 282, 215, 90, 2, 0, 0, 0, 0, 0, 0,
  ],
  [
    2006, 952, 901, 737, 514, 514, 514, 446, 446, 446, 333, 497, 368, 413, 271,
    341, 280, 280, 204, 31, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2007, 1192, 994, 829, 569, 569, 569, 484, 484, 484, 483, 473, 466, 465, 295,
    305, 296, 296, 222, 94, 0, 0, 0, 0, 0, 1, 0,
  ],
  [
    2008, 998, 892, 800, 550, 550, 550, 557, 557, 557, 444, 475, 503, 438, 310,
    331, 229, 229, 197, 95, 1, 0, 0, 0, 0, 0, 0,
  ],
  [
    2009, 1192, 1216, 1097, 791, 791, 791, 744, 744, 744, 602, 606, 521, 561,
    402, 409, 363, 363, 326, 193, 2, 0, 0, 0, 1, 0, 0,
  ],
  [
    2010, 1135, 1108, 911, 659, 659, 659, 608, 608, 608, 499, 627, 439, 502,
    299, 348, 294, 294, 226, 175, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2011, 947, 934, 776, 611, 611, 611, 616, 616, 616, 503, 455, 410, 411, 297,
    381, 288, 288, 211, 146, 0, 0, 2, 0, 0, 0, 0,
  ],
  [
    2012, 1053, 956, 772, 596, 596, 596, 661, 661, 661, 520, 443, 448, 421, 314,
    333, 214, 214, 187, 237, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2013, 1052, 915, 738, 600, 600, 600, 646, 646, 646, 501, 430, 449, 428, 303,
    307, 250, 250, 192, 187, 0, 0, 1, 0, 0, 0, 0,
  ],
  [
    2014, 1099, 859, 799, 593, 593, 593, 652, 652, 652, 503, 395, 450, 451, 287,
    293, 180, 180, 210, 193, 0, 0, 1, 0, 0, 1, 0,
  ],
  [
    2015, 1324, 830, 896, 701, 701, 701, 656, 656, 656, 519, 456, 509, 487, 400,
    345, 208, 208, 217, 226, 0, 0, 1, 0, 0, 1, 0,
  ],
  [
    2016, 1190, 884, 822, 680, 680, 680, 636, 636, 636, 608, 406, 479, 444, 336,
    324, 250, 250, 238, 274, 0, 0, 0, 0, 0, 0, 0,
  ],
  [
    2017, 1230, 766, 707, 607, 607, 607, 658, 658, 658, 577, 433, 448, 422, 361,
    341, 224, 224, 191, 208, 0, 0, 0, 0, 0, 1, 0,
  ],
  [
    2018, 1273, 768, 693, 624, 624, 624, 660, 660, 660, 585, 479, 486, 343, 375,
    256, 248, 248, 213, 307, 0, 0, 1, 0, 0, 2, 0,
  ],
  [
    2019, 1159, 891, 564, 587, 587, 587, 613, 613, 613, 697, 370, 509, 299, 324,
    312, 194, 194, 220, 346, 1, 0, 0, 0, 0, 1, 0,
  ],
  [
    2020, 1240, 930, 746, 526, 526, 526, 655, 655, 655, 595, 392, 515, 397, 376,
    295, 244, 244, 240, 285, 1, 0, 1, 0, 0, 0, 0,
  ],
  [
    2021, 1206, 969, 638, 548, 548, 548, 531, 531, 531, 468, 434, 395, 326, 319,
    308, 249, 249, 233, 220, 1, 0, 0, 0, 0, 0, 0,
  ],
];

const chart1Type = reactive({
  select: 1,
  opt: [
    {
      text: "NSF Directorate Top10 资金分布",
      value: 0,
      yName: "百万美元",
      dataSet: dataSet1,
    },
    {
      text: "NSF 一级学科资金数",
      value: 1,
      yName: "百万美元",
      dataSet: dataSet2,
    },
    {
      text: "NSF 一级学科项目数",
      value: 2,
      yName: "个",
      dataSet: dataSet3,
    },
    {
      text: "NSF 二级学科资金数",
      value: 3,
      yName: "百万美元",
      dataSet: dataSet4,
    },
    {
      text: "NSF 二级学科项目数",
      value: 4,
      yName: "个",
      dataSet: dataSet5,
    },
  ],
});

let myChart1: echarts.ECharts, myChart2: echarts.ECharts;

const updateChart = _.debounce(async () => {
  let option = extendEchartsOpts({
    title: {
      left: "center",
      top: "1%",
      textAlign: "center",
      textStyle: {
        fontSize: 20,
      },
      text: "NSF 项目数和资金数",
    },
    xAxis: {
      // max: 5,
      type: "category",
    },
    legend: {
      show: true,
    },
    yAxis: [
      {
        position: "left",
        name: "数量",
      },
      {
        name: "百万美元",
        position: "right",
      },
    ],
    dataset: {
      source: dataSet,
    },
    tooltip: {
      formatter: function (params: any) {
        params.sort((x: any, y: any) => {
          let dataIDX: number = x.encode.y[0];
          let dataIDY: number = y.encode.y[0];
          // if (y.data === undefined) {
          //   return -1;
          // }
          return y.data[dataIDY] - x.data[dataIDX];
        });
        let showHtm = ` ${params[0].name}<br>`;
        for (let i = 0; i < params.length; i++) {
          let dataID: number = params[i].encode.y[0];
          if (params[i].data === undefined) {
            continue;
          }
          const _text = params[i].seriesName;
          const _data = params[i].data[dataID];
          const _marker = params[i].marker;
          showHtm += `${_marker}${_text}：${_data}<br>`;
        }
        return showHtm;
      },
    },
    series: [
      {
        type: "line",
        name: "项目数",
        yAxisIndex: 0,
        encode: {
          x: "year",
          y: "NOI",
        },
      },
      {
        type: "line",
        name: "资金数",
        yAxisIndex: 1,
        encode: {
          x: "year",
          y: "fundM",
        },
      },
      {
        type: "line",
        name: "GPD统一资金数",
        yAxisIndex: 1,
        encode: {
          x: "year",
          y: "UfundM",
        },
      },
    ],
  });
  myChart1.setOption(option);
}, 1000);

const updateNextChart = _.debounce(async () => {
  // directoract 资金分布
  let dataID = chart1Type.select;
  const option = extendEchartsOpts({
    title: {
      left: "center",
      top: "1%",
      textAlign: "center",
      textStyle: {
        fontSize: 20,
      },
      text: chart1Type.opt[dataID].text,
    },
    xAxis: {
      // max: 5,
      type: "category",
    },
    legend: {
      show: true,
    },
    yAxis: {
      position: "left",
      name: chart1Type.opt[dataID].yName,
    },
    dataset: {
      source: chart1Type.opt[dataID].dataSet,
    },
    tooltip: {
      formatter: function (params: any) {
        params.sort((x: any, y: any) => {
          let dataIDX: number = x.encode.y[0];
          let dataIDY: number = y.encode.y[0];
          // if (y.data === undefined) {
          //   return -1;
          // }
          return y.data[dataIDY] - x.data[dataIDX];
        });
        let showHtm = ` ${params[0].name}<br>`;
        for (let i = 0; i < params.length; i++) {
          let dataID: number = params[i].encode.y[0];
          if (params[i].data === undefined) {
            continue;
          }
          const _text = params[i].seriesName;
          const _data = params[i].data[dataID];
          const _marker = params[i].marker;
          showHtm += `${_marker}${_text}：${_data}<br>`;
        }
        return showHtm;
      },
    },
    series: chart1Type.opt[dataID].dataSet[0].slice(1, -1).map(() => {
      return { type: "line" };
    }),
  });
  console.log(option);
  myChart2.clear();
  myChart2.setOption(option);
}, 1000);

onMounted(() => {
  let elem = document.getElementById("echart1");
  if (elem) {
    myChart1 = echarts.init(elem);
  }
  elem = document.getElementById("echart2");
  if (elem) {
    myChart2 = echarts.init(elem);
  }
  updateChart();
  updateNextChart();
});
</script>

<style lang="less">
.el-col {
  margin: 20px 10px;
}
.echart {
  width: 95vw;
  height: 600px;
}
</style>
